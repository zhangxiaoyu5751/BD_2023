# 为什么要进行数仓建模？
1. 访问性能。能够快速查询所需的数据，减少数据IO
2. 数据成本。减少不必要的数据冗余，实现计算结果数据复用，降低系统的存储成本和计算成本
3. 使用效率。提高用户使用体验，提高数据使用和产出效率
4. 数据质量。改善统计口径的不一致性，减少数据计算错误的可能性。提供高质量的数据给业务方用。

# 常见的建模方法
## 范式建模(E-R模型)
将事物抽象成实体、属性、关系来表示数据之间的关联和事物描述。这种对数据的抽象建模通常被称为ER实体关系建模。该建模方法需要满足3范式。
具体3范式：
1. 表中的每一列都是不可拆分的原子项
2. 没有部分依赖。所有非主属性都完全依赖于主键
3. 没有传递依赖。非主关键字不能依赖其他非主关键字。非关键字之间不能有依赖关系。
建模步骤如下：
1. 抽象出实体
2. 梳理实体之间的关系
3. 梳理实体的属性
4. 画出E-R图

## 维度建模
确定业务过程
确定粒度
确定维度
确定事实
## data vault模型(是对ER模型的更进一步规范化)
是一种中心辐射式的模型，设计重点围绕着业务键的集成模式。主要是为了强调数据的历史性，可追溯性和原子性。不能直接用于数据分析决策。
中心表hub：唯一业务键的列表，唯一标识企业实际业务，企业的业务主体的集合。只包含业务主键信息以及数据装载的描述，不包含非键值以外的业务数据属性本身。
链接表Link：用来描述中心表之间的关联关系。也不包含业务键值以及数据装在描述意外的任何非键值数据。
卫星表SAtellite:数仓中数据的主要载体，包括对链接表，中心表的数据描述，数值度量等信息。
建模流程：
1. 梳理所有实体
2. 将有入边的实体定义为中心表
3. 将没有入边且仅有一个出边的表定义为中心表
4. 没有入边，且有两条或者以上出边的表定义为链接表
5. 将外键关系定义为链接表

## anchor
基于data vault进一步的规范化处理，初衷是为了设计高度可扩展的模型，设计的模型基本都是K-V结构的模型，范式达到了6NF

# 维度建模和范式建模优缺点
ER模型比较适合于OLTP建模，不太适合支持数据分析。需要全面的梳理企业的所有业务和数据流，周期比较长，对人员要求比较高。比较适合长期稳定的业务。

维度建模比较适合支持快速灵活的分析需求，同时能够提供大规模数据的快速响应性能。不需要完整的梳理企业业务流程和数据。

1. 范式建模主要是强调数据的规范化和一致性，维度建模主要侧重数据的易用和性能
2. 范式建模主要使用范式化的表来存储数据，维度建模则主要是星星模型和雪花模型
3. 范式建模适用于企业应用程序和大型数据处理系统，维度建模适用于数仓场景。

# 数仓分层好处
1. 清晰的数据架构
2. 清晰的数据血缘并能够进行追踪
3. 减少重复开发
4. 复杂问题简单化
5. 屏蔽原始数据影响
# 建模原则
1. 高内聚 低耦合
主体内部高内聚，不同主题低耦合。
2. 核心模型和扩展模型要分离
不要让扩展模型的字段过度侵入核心模型，以免破坏核心模型的架构简洁性和可维护性
3. 公共处理逻辑下沉及单一
4. 成本和性能的平衡
适当的数据冗余可换取查询和刷新性能，不宜过度冗余
5. 数据可回滚
处理逻辑不变，在不同时间多次运行数据结果确定不变。